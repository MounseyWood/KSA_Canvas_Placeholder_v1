<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interactive Text Camouflage</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/papaparse/5.3.0/papaparse.min.js"></script>
    <style>
        html, body {
            margin: 0;
            padding: 0;
            width: 100%;
            height: 100%;
            background-color: #000000;
            overflow: hidden;
            font-family: Arial, sans-serif;
        }
        
        .container {
            position: relative;
            width: 100%;
            height: 100vh;
            background-color: #fff200;
            overflow: hidden;
        }
        
        .text-layer {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            padding: 10px;
            box-sizing: border-box;
            line-height: 1.2;
        }
        
        .word {
            display: inline-block;
            margin-right: 5px;
            color: #000000;
            cursor: pointer;
            transition: color 0.2s, font-weight 0.2s;
        }
        
        .word:hover {
            color: #ffffff;
            font-weight: bold;
        }

        .loading {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: #000000;
            font-size: 24px;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="container" id="container">
        <div class="text-layer" id="textLayer">
            <div class="loading">Loading words...</div>
        </div>
    </div>

    <script>
        // Array to store words from CSV
        let words = [];
        let wordsLoaded = false;

        // Function to load words from CSV file
        function loadWordsFromCSV() {
            fetch('words.csv')
                .then(response => {
                    if (!response.ok) {
                        throw new Error('CSV file not found');
                    }
                    return response.text();
                })
                .then(csvData => {
                    // Parse CSV data using PapaParse
                    const results = Papa.parse(csvData, {
                        header: true,
                        skipEmptyLines: true
                    });
                    
                    // Extract words from the parsed data
                    // This tries multiple approaches to find the words in the CSV
                    if (results.data && results.data.length > 0) {
                        // Try to find a column named 'word' or the first column
                        words = results.data.map(row => {
                            // If there's a column named 'word', use that
                            if (row.word) return row.word;
                            // If there's a column named 'Word', use that
                            if (row.Word) return row.Word;
                            // Otherwise use the first value
                            return Object.values(row)[0];
                        }).filter(word => word && word.trim() !== '');
                    }
                    
                    // If no words were found, use some defaults
                    if (words.length === 0) {
                        words = ["Placeholder", "Example", "Default", "Backup", "Word"];
                        console.warn("No words found in CSV. Using default words.");
                    } else {
                        console.log(`Successfully loaded ${words.length} words from CSV`);
                    }
                    
                    wordsLoaded = true;
                    
                    // Now create the text pattern
                    createTextPattern();
                    addInteractivity();
                })
                .catch(error => {
                    console.error("Error loading CSV:", error);
                    
                    // Use default words if CSV loading fails
                    words = ["Placeholder", "Example", "Default", "Backup", "Word"];
                    wordsLoaded = true;
                    
                    // Create the text pattern even if there was an error
                    createTextPattern();
                    addInteractivity();
                });
        }

        // Function to generate random words
        function getRandomWord() {
            return words[Math.floor(Math.random() * words.length)];
        }

        // Function to get random font weight
        function getRandomWeight() {
            const weights = [300, 400, 500, 600, 700];
            return weights[Math.floor(Math.random() * weights.length)];
        }

        // Function to create text pattern
        function createTextPattern() {
            const textLayer = document.getElementById('textLayer');
            let content = '';
            
            // Generate enough words to fill the screen - based on screen size
            const wordCount = Math.ceil((window.innerWidth * window.innerHeight) / 2000);
            
            for (let i = 0; i < wordCount; i++) {
                content += `<span class="word" style="font-weight: ${getRandomWeight()}">${getRandomWord()}</span>`;
            }
            
            textLayer.innerHTML = content;
        }

        // Add interactivity
        function addInteractivity() {
            const words = document.querySelectorAll('.word');
            
            words.forEach(word => {
                word.addEventListener('mouseover', () => {
                    // Random chance of triggering nearby words for a "ripple" effect
                    if (Math.random() < 0.3) {
                        const nearbyWords = Array.from(words).filter(() => Math.random() < 0.05);
                        nearbyWords.forEach(nearby => {
                            nearby.style.color = '#ffffff';
                            setTimeout(() => {
                                nearby.style.color = '#000000';
                            }, 500 + Math.random() * 1000);
                        });
                    }
                });
                
                word.addEventListener('click', () => {
                    // Create a ripple effect on click
                    const rippleEffect = () => {
                        const nearbyWords = Array.from(words).filter(() => Math.random() < 0.1);
                        nearbyWords.forEach(nearby => {
                            nearby.style.color = '#ffffff';
                            setTimeout(() => {
                                nearby.style.color = '#000000';
                            }, 200 + Math.random() * 800);
                        });
                    };
                    
                    // Create multiple ripples
                    for (let i = 0; i < 5; i++) {
                        setTimeout(rippleEffect, i * 100);
                    }
                });
            });
            
            // Add mouse movement effect
            document.addEventListener('mousemove', (e) => {
                const x = e.clientX;
                const y = e.clientY;
                
                // Find words near the cursor
                words.forEach(word => {
                    const rect = word.getBoundingClientRect();
                    const wordX = rect.left + rect.width / 2;
                    const wordY = rect.top + rect.height / 2;
                    
                    const distance = Math.sqrt(Math.pow(x - wordX, 2) + Math.pow(y - wordY, 2));
                    
                    if (distance < 100) {
                        const intensity = 1 - distance / 100;
                        word.style.fontWeight = Math.floor(400 + intensity * 300);
                    }
                });
            });
        }

        // Handle window resize
        function handleResize() {
            if (wordsLoaded) {
                createTextPattern();
                addInteractivity();
            }
        }

        // Initialize the pattern
        window.onload = function() {
            // Load words from CSV first, then create the pattern
            loadWordsFromCSV();
            
            // Add window resize handler
            window.addEventListener('resize', handleResize);
        };
    </script>
</body>
</html>
